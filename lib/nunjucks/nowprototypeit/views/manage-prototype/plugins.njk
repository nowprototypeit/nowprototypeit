{% extends "nowprototypeit/views/manage-prototype/layout.njk" %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/label/macro.njk" import govukLabel %}
{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "govuk/components/tag/macro.njk" import govukTag %}

{% block content %}
        <div class="govuk-grid-row govuk-!-margin-bottom-5">
            <div class="govuk-grid-column-two-thirds-from-desktop">
                <h1 class="govuk-heading-l">Plugins</h1>
                <p class="govuk-body">
                    Plugins provide you with new components, styles and other features.
                </p>
            </div>
        </div>

        <div class="govuk-grid-row">
            <div class="govuk-grid-column-one-quarter">
              {% for link in sideNavLinks %}
                <div class="sub-nav {% if link.isCurrentPage %}sub-nav__current{%endif%}">
                  {% if not link.isCurrentPage %}
                    <a href="{{ link.url }}">
                        {{ link.text }}
                    </a>
                  {% else %}
                    {{ link.text }}
                  {% endif %}
                </div>
              {% endfor %}
            </div>

            <div class="govuk-grid-column-three-quarters">
                <form method="post" action="">
                {% if isSearchPage %}
                <p class="govuk-body">The plugins listed here are
                   not managed by Now Prototype It (unless specified otherwise) so we cannot take responsibility for
                   the reliability or safety of these plugins.</p>
                <div class="govuk-!-margin-bottom-5">
                    <div id="search-container">
                        {{ govukLabel({
                            text:"Search",
                            classes:"govuk-!-font-weight-bold"
                        }) }}

                        {{ govukInput({
                            id: "search",
                            classes: "govuk-!-width-one-half",
                            formGroup: {
                                classes: "govuk-!-margin-bottom-3"
                            },
                            name: "search",
                            value: search
                        }) }}

                        <div class="govuk-button-group">
                            {{ govukButton({
                                text: "Search",
                                classes: "govuk-button--secondary",
                                attributes: { id: "search-button", formaction: "#" }
                            }) }}

                            {% if search %}
                                <a class="govuk-link govuk-link--no-visited-state" href="?">Clear search</a>
                            {% endif %}
                        </div>
                    </div>
                    <h3 class="govuk-body govuk-!-font-weight-bold">
                        {{ foundMessage }}
                    </h3>
                </div>
                {% endif %}

                <ul class="govuk-list nowprototypeit-manage-prototype-plugin-list-plugin-list"
                    data-plugin-group-status="{{ status }}">
                    {% if plugins.length === 0 %}
                      {% if isInstalledPage %}
                        <p>It looks like you don't have any plugins installed.</p>
                      {% else %}
                        <p>We couldn't find any plugins, looks like something went wrong.  Feel free to <a href="https://github.com/nowprototypeit/govuk/issues" target="_blank">raise us a ticket</a>.
                      {% endif %}
                    {% endif %}
                    {% for plugin in plugins %}
                        <li class="nowprototypeit-manage-prototype-plugin-list-plugin-list__item"
                            data-plugin-package-name="{{ plugin.packageName }}">

                            <div class="govuk-grid-column-one-third govuk-body">
                                <h4 class="govuk-body govuk-!-font-weight-bold">
                                    <a class="plugin-details-link" href="{{ plugin.pluginDetailsLink }}">{{ plugin.name }}</a>
                                </h4>
                                {% if plugin.scope %}
                                    <div>
                                        By {{ plugin.scope }}
                                    </div>
                                {% endif %}
                                {% if plugin.isInstalled %}
                                    <div class="govuk-!-margin-top-3">
                                        v{{ plugin.installedVersion }}
                                    </div>
                                {% endif %}
                            </div>
                            <div class="govuk-grid-column-two-thirds govuk-body">
                                {% if isSearchPage and plugin.isInstalled %}
                                    <p>
                                        {{ govukTag({
                                            text: "Installed",
                                            classes: "govuk-tag--grey"
                                        }) }}
                                    </p>
                                {% endif %}
                                {% if plugin.updateAvailable %}
                                <p>
                                    
                                    {{ govukTag({
                                        html: 'Update available',
                                        classes: "govuk-tag--grey govuk-prototype-kit-update-available"
                                    }) }}
                                </p>
                                {% endif %}
                                {% if plugin.description %}
                                    <div class="govuk-!-margin-bottom-3">
                                        {{ plugin.description }}
                                    </div>
                                {% endif %}
                                <div class="nowprototypeit-manage-prototype-plugin-list-plugin-list__item-buttons">
                                    <div class="govuk-button-group">
                                        {% if plugin.helpLink %}
                                            <a class=""
                                               href="{{ plugin.helpLink }}">Help<span
                                                        class="govuk-visually-hidden"> - {{ plugin.name }}</span></a>
                                        {% endif %}
                                     </div>
                                </div>
                            </div>
                        </li>
                    {% endfor %}
                </ul>
                </form>
              {% if showPluginLookup %}
                {% include "views/manage-prototype/lookup-plugin.njk" %}
              {% endif %}
            </div>
        </div>
{% endblock %}
